const CLIENT_ID="945330460050-osmelc2uen8vhdesa6kd55vvjivkm5vs.apps.googleusercontent.com",API_KEY="AIzaSyD_EbPMAwZ9EDHiLHqGToi7-31ZnwXHams",DISCOVERY_DOCS=["https://sheets.googleapis.com/$discovery/rest?version=v4"],SCOPES="https://www.googleapis.com/auth/drive.file";let level,enjaList=[],draggies=[],test1method,test2count=0,test2score=0,test2problems=[],englishVoices=[];loadVoices();let pendingPush,testLength=20;const maxTestLength=20;loadConfig();const audioContext=new AudioContext,audioBufferCache={};loadAudio("correct","/vocabee/mp3/correct3.mp3"),loadAudio("incorrect","/vocabee/mp3/incorrect1.mp3"),initFromIndexedDB();const carousel=new bootstrap.Carousel(document.getElementById("main"),{interval:!1,touch:!1}),modalNode=document.getElementById("modal"),modal=new bootstrap.Modal(modalNode);function loadConfig(){localStorage.getItem("darkMode")==1&&document.documentElement.setAttribute("data-bs-theme","dark"),localStorage.getItem("voice")!=1&&(document.getElementById("voiceOn").classList.add("d-none"),document.getElementById("voiceOff").classList.remove("d-none"))}function toggleDarkMode(){localStorage.getItem("darkMode")==1?(localStorage.setItem("darkMode",0),document.documentElement.setAttribute("data-bs-theme","light")):(localStorage.setItem("darkMode",1),document.documentElement.setAttribute("data-bs-theme","dark"))}async function playAudio(e,t){const s=await loadAudio(e,audioBufferCache[e]),n=audioContext.createBufferSource();if(n.buffer=s,t){const e=audioContext.createGain();e.gain.value=t,e.connect(audioContext.destination),n.connect(e),n.start()}else n.connect(audioContext.destination),n.start()}async function loadAudio(e,t){if(audioBufferCache[e])return audioBufferCache[e];const s=await fetch(t),o=await s.arrayBuffer(),n=await audioContext.decodeAudioData(o);return audioBufferCache[e]=n,n}function unlockAudio(){audioContext.resume()}function toggleVoice(){speechSynthesis.cancel(),localStorage.getItem("voice")==1?(localStorage.setItem("voice",0),document.getElementById("voiceOn").classList.add("d-none"),document.getElementById("voiceOff").classList.remove("d-none")):(localStorage.setItem("voice",1),document.getElementById("voiceOn").classList.remove("d-none"),document.getElementById("voiceOff").classList.add("d-none"))}function loadVoices(){const e=new Promise(function(e){let t=speechSynthesis.getVoices();if(t.length!==0)e(t);else{let n=!1;speechSynthesis.addEventListener("voiceschanged",function(){n=!0,t=speechSynthesis.getVoices(),e(t)}),setTimeout(()=>{n||document.getElementById("noTTS").classList.remove("d-none")},1e3)}}),t=["com.apple.speech.synthesis.voice.Bahh","com.apple.speech.synthesis.voice.Albert","com.apple.speech.synthesis.voice.Hysterical","com.apple.speech.synthesis.voice.Organ","com.apple.speech.synthesis.voice.Cellos","com.apple.speech.synthesis.voice.Zarvox","com.apple.speech.synthesis.voice.Bells","com.apple.speech.synthesis.voice.Trinoids","com.apple.speech.synthesis.voice.Boing","com.apple.speech.synthesis.voice.Whisper","com.apple.speech.synthesis.voice.Deranged","com.apple.speech.synthesis.voice.GoodNews","com.apple.speech.synthesis.voice.BadNews","com.apple.speech.synthesis.voice.Bubbles"];e.then(e=>{englishVoices=e.filter(e=>e.lang=="en-US").filter(e=>!t.includes(e.voiceURI))})}function loopVoice(e,t){speechSynthesis.cancel();const n=new SpeechSynthesisUtterance(e);n.voice=englishVoices[Math.floor(Math.random()*englishVoices.length)],n.lang="en-US";for(let e=0;e<t;e++)speechSynthesis.speak(n)}function setLearningButton(e,t){const n=document.getElementById(e);n.textContent=t,t==0?n.parentNode.setAttribute("disabled",!0):n.parentNode.removeAttribute("disabled")}function loadEnjaListFromIndexedDB(e,t){openDB(n=>{const s={};getAllWords(n,e).then(n=>{n.forEach(e=>{s[e.lemma]=e.state}),enjaList=[],fetch("/vocabee/data/"+e+".tsv").then(e=>e.text()).then(e=>{e.split(`
`).forEach(e=>{const[t,n]=e.split("	");enjaList.push([t,n,s[t]])}),t()})})})}function getPlanRange(e){switch(!0){case e<=1800:return 200;case e<=2600:return 400;default:return 1e3}}function loadPlans(e){const[t,n]=e,s=getPlanRange(level)-n-t;setLearningButton("known",n),setLearningButton("unlearned",t),setLearningButton("learning",s)}function loadProgresses(e){const t=[...document.getElementById("seqTest").children];t.forEach((t,n)=>{const[i,s]=e[n],o=Math.ceil(s/enjaList.length*1e3);t.max=enjaList.length/10,t.value=s,t.title=o+"%"})}function updatePlan(e,t){const n=document.getElementById(e);n.textContent=t;const s=n.parentNode;s.classList.add("animate__animated","animate__flipInY"),s.removeAttribute("disabled")}function updatePlans(e,t,n){const s=parseInt(document.getElementById("known").textContent),o=parseInt(document.getElementById("unlearned").textContent),i=parseInt(document.getElementById("learning").textContent),a=s+e,r=o+t,c=i+n;updatePlan("known",a),updatePlan("unlearned",r),updatePlan("learning",c)}function openDB(e){const t=indexedDB.open("vocabee");t.onsuccess=t=>e(t.target.result),t.onerror=()=>console.log("failed to open db"),t.onupgradeneeded=e=>{const t=e.target.result;t.createObjectStore("index",{keyPath:"level"});const n=t.createObjectStore("words",{keyPath:"lemma"});n.createIndex("level","level",{unique:!1})}}function getAllWords(e,t){return new Promise((n,s)=>{let i;const a="words",o=e.transaction(a,"readonly"),r=o.objectStore(a).index("level").getAll(t);o.oncomplete=()=>n(i),o.onerror=e=>s(e),r.onsuccess=e=>{i=e.target.result}})}function getWordState(e,t){return new Promise((n,s)=>{let i;const a="words",o=e.transaction(a,"readonly"),r=o.objectStore(a).get(t);o.oncomplete=()=>n(i),o.onerror=e=>s(e),r.onsuccess=e=>{const t=e.target.result;t?i=t.state:void 0}})}function putIndex(e){openDB(t=>{const n="index";let s=0;enjaList.forEach(e=>{e[2]&&e[2].slice(-1)=="o"&&(s+=1)});const i={level,known:s},o=t.transaction(n,"readwrite").objectStore(n).put(i);o.onsuccess=t=>{e&&e(t)},o.onerror=()=>console.log("failed to put")})}function putWordState(e,t,n,s){const o="words",a={lemma:t,level,state:n},i=e.transaction(o,"readwrite").objectStore(o).put(a);i.onsuccess=e=>{s&&s(e)},i.onerror=()=>console.log("failed to put")}function putWord(e,t){openDB(n=>{getWordState(n,e).then(s=>{s?s+=t:s=t,putWordState(n,e,s)})})}function putWords(){openDB(e=>{enjaList.forEach(t=>{const n=t[0],s=t[2];putWordState(e,n,s)})})}function putWordsBase(e,t){const o=[...document.getElementById(e).lastElementChild.children],n=o.map(e=>e.textContent),s=n.map(e=>enjaList.findIndex(t=>t[0]==e));return n.forEach((e,n)=>{updateEnjaListState(s[n],t),putWord(e,t)}),s}function putWordsFromTest1(){const e=putWordsBase("test1known","o"),t=putWordsBase("test1learning","x");return updateProgresses(e,1),[e.length,t.length]}function updateEnjaListState(e,t){const n=enjaList[e][2];n?enjaList[e][2]+=t:enjaList[e][2]=t}function updateProgresses(e,t){const n={},o=[...document.getElementById("seqTest").children];e.forEach(e=>{const s=Math.floor(e/(enjaList.length/10));s in n?n[s]+=t:n[s]=t});let s=0;for(const[a,t]of Object.entries(n)){const r=parseInt(a),e=o[r],i=parseInt(e.value)+t,c=parseInt(e.max);e.value=i,e.title=Math.ceil(i/c*100)+"%",e.classList.add("animate__animated","animate__bounceInLeft"),s+=t}return s}function updateProgress(e,t){const o=[...document.getElementById("seqTest").children],i=Math.floor(e/(enjaList.length/10)),n=o[i],s=parseInt(n.value)+t,a=parseInt(n.max);n.value=s,n.title=Math.ceil(s/a*100)+"%",n.classList.add("animate__animated","animate__bounceInLeft")}function updateViewByKnown(){putWordsBase("test1known","o");const t=putWordsBase("test1learning","x"),e=updateProgresses(t,-1);updatePlans(e,0,-e)}function updateViewByLearning(){const t=putWordsBase("test1known","o");putWordsBase("test1learning","x");const e=updateProgresses(t,1);updatePlans(e,0,-e)}function test1moveTop(){switch(draggies.forEach(e=>{e.destroy()}),draggies=[],test1method){case"known":{updateViewByKnown();break}case"unlearned":{const[e,t]=putWordsFromTest1();updatePlans(e,-e-t,t);break}case"learning":{updateViewByLearning();break}}navigator.onLine?(pushWords(),pushIndex()):pendingPush=!0,putIndex(),moveTop()}function searchByGoogle(e){e.preventDefault();const t=document.getElementById("cse-search-input-box-id");document.getElementById("searchResults").classList.remove("d-none");const n=google.search.cse.element.getElement("searchresults-only0");t.value==""?n.clearAllResults():n.execute(t.value)}document.getElementById("cse-search-box-form-id").onsubmit=searchByGoogle;function search(e){const n=e.target.id.slice(6),t=document.getElementById("modal-title").textContent;switch(n){case"Google":window.open(`https://www.google.com/search?q=${t}+ÊÑèÂë≥`);return;case"Eijiro":window.open(`https://eow.alc.co.jp/search?q=${t}`);return;case"Weblio1":window.open(`https://ejje.weblio.jp/content/${t}`);return;case"Weblio2":window.open(`https://ejje.weblio.jp/sentence/content/${t}`);return;case"ReversoContext":window.open(`https://context.reverso.net/ÁøªË®≥/Ëã±Ë™û-Êó•Êú¨Ë™û/${t}`);return}}function addDragEvent(e,t,n){const o=document.getElementById("test1known"),i=document.getElementById("test1learning"),a=document.getElementById("dragZone"),s=new Draggabilly(e);n||(e.textContent=t[0],e.classList.add("btn-lg")),s.on("staticClick",function(){document.getElementById("meaning").textContent=t[1].split("|").join(", "),document.getElementById("modal-title").textContent=t[0],modal.toggle("toggle")}),s.on("dragStart",function(){const o=e.getBoundingClientRect();document.body.appendChild(e);const i=e.getBoundingClientRect();s.setPosition(o.left-i.left,o.top-i.top)}),s.on("dragEnd",function(){if(e.removeAttribute("style"),e.classList.remove("btn-lg"),s.position.y<0){const t=o.lastElementChild;t.insertBefore(e,t.firstElementChild)}else{const t=i.lastElementChild;t.insertBefore(e,t.firstElementChild)}draggies=draggies.filter(e=>e!=s),s.destroy(),addDragEvent(e,t,!0),a.children.length==0&&document.getElementById("test1moveTop").classList.remove("d-none")}),draggies.push(s)}function getRandomInt(e){return Math.floor(Math.random()*e)}function setProblems(e,t){test1method=e;const n=getTargetStateProblems(t),s=document.getElementById("dragZone"),o=[...s.children],i=document.getElementById("test1noneed");o.forEach((e,t)=>{t>=n.length?i.appendChild(e):addDragEvent(e,n[t])})}function getTargetStateProblems(e){const t=[];return enjaList.some(n=>{if(n[2]&&n[2].slice(-1)==e&&(t.push(n),t.length>=maxTestLength))return!0}),t}function getUnlearnedProblems(){const e=[];return enjaList.some(t=>{if(!t[2]&&(e.push(t),e.length>=maxTestLength))return!0}),e}function setUnlearnedProblems(){test1method="unlearned";const e=getUnlearnedProblems(),t=document.getElementById("dragZone"),n=document.getElementById("test1noneed");[...t.children].forEach((t,s)=>{s>=e.length?n.appendChild(t):addDragEvent(t,e[s])})}function moveTop(){carousel.to(0)}function test1cleanup(){document.getElementById("test1moveTop").classList.add("d-none");const e=document.getElementById("dragZone"),t=document.getElementById("test1known"),n=document.getElementById("test1learning"),s=document.getElementById("test1noneed"),o=[...t.lastElementChild.children].concat([...n.lastElementChild.children]).concat([...s.children]);o.forEach(t=>{e.appendChild(t)}),carousel.to(1)}function test1(e){switch(test1cleanup(),e){case"known":return setProblems("known","o");case"unlearned":return setUnlearnedProblems();case"learning":return setProblems("learning","x")}}class Choice{constructor(e,t,n,s){this.en=e,this.ja=t,this.desc=n,this.isAnswer=s}}function test2selectAnswers(e,t){const n=enjaList.concat();switch(e){case"all":return shuffle(n),n.slice(0,maxTestLength);case"learning":{const e=n.filter(e=>e[2]&&e[2].slice(-1)=="x");return e.length<maxTestLength?e:e.slice(0,maxTestLength)}default:{const e=n.length/10,s=e*t,o=n.slice(s,s+e);return shuffle(o).slice(0,maxTestLength)}}}function test2generateProblems(e,t){const n=test2selectAnswers(e,t);testLength=n.length;const s=[];return n.forEach(e=>{const t=test2generateChoices(e);s.push(t)}),s}function generateChoice(e,t){const n=e[1].split("|");shuffle(n);const s=n.slice(0,3).join(", "),[o,i]=e;return new Choice(o,s,i.split("|"),t)}function test2generateChoices(e){const t=[generateChoice(e,!0)];for(;t.length!=4;){const n=enjaList[getRandomInt(enjaList.length)];if(n[0]!=e[0]){const e=generateChoice(n,!1);t.every(t=>!t.desc.includes(e.ja))&&t.push(e)}}return t}function shuffle(e){let t=e.length,s,n;for(;0!==t;)n=Math.floor(Math.random()*t),t-=1,s=e[t],e[t]=e[n],e[n]=s;return e}function test2setButtons(e,t,n){e?(document.getElementById("test2lemma").textContent=n[0].en,loopVoice(n[0].en,3)):document.getElementById("test2lemma").textContent=n[0].ja,shuffle(n).forEach((n,s)=>{t[s].classList.remove("text-danger"),e?t[s].textContent=n.ja:t[s].textContent=n.en,n.isAnswer?t[s].setAttribute("data-answer","true"):t[s].removeAttribute("data-answer")})}function test2getTrs(){const e=[...document.getElementById("test2table1").getElementsByTagName("tr")],t=[...document.getElementById("test2table2").getElementsByTagName("tr")];return e.concat(t)}function test2setResult(e,t){const s=test2getTrs(),o=s[e-1],n=o.children;n[0].firstChild.textContent="üîä",n[1].textContent=t[0].en,n[2].textContent=t[0].desc}function test2cleanResult(){const e=test2getTrs();e.forEach(e=>{const t=e.children;t[0].firstChild.textContent="",t[1].textContent="",t[2].textContent=""})}function test2all(){test2base("all")}function test2learning(){test2base("learning")}function test2seq(e){const t=[...document.getElementById("seqTest").children],n=t.findIndex(t=>t==e.target);test2base("seq",n)}function test2base(e,t){const s=test2getTrs();s.forEach(e=>{e.classList.remove("table-danger")}),test2problems=test2generateProblems(e,t),test2count=1,test2score=0;const o=[...document.getElementById("choices").children],n=document.getElementById("testType1").checked;test2cleanResult(),test2setResult(test2count,test2problems[0]),test2setButtons(n,o,test2problems[0]),n?document.getElementById("test2voice").classList.remove("d-none"):document.getElementById("test2voice").classList.add("d-none"),carousel.to(2)}function test2countScore(){const e=[...document.getElementById("choices").children];return e.every(e=>!e.classList.contains("text-danger"))}function test2moveTop(){navigator.onLine?(pushWords(),pushIndex()):pendingPush=!0,putIndex(),moveTop()}function test2put(e,t){const s=enjaList.findIndex(t=>t[0]==e);let n=enjaList[s][2],o,i=0,r=0,a=0;t?(o="o",updateEnjaListState(s,o),n?n.slice(-1)=="x"&&(a-=1,i+=1,updateProgress(s,1)):(r-=1,i+=1,updateProgress(s,1))):(o="x",updateEnjaListState(s,o),n?n.slice(-1)=="o"&&(i-=1,a+=1,updateProgress(s,-1)):(r-=1,a+=1)),openDB(t=>{n?n+=o:n=o,putWordState(t,e,n),updatePlans(i,r,a)})}function test2select(e){const t=[...document.getElementById("choices").children],n=test2problems[test2count-1],s=document.getElementById("testType1").checked;if(e.target.dataset.answer){test2count+=1;const o=test2countScore();test2score+=o,playAudio("correct",.3),e.target.textContent="‚≠ï "+e.target.textContent;const i=n.find(e=>e.isAnswer).en;if(test2put(i,o),test2count>testLength)document.getElementById("score").textContent=test2score,document.getElementById("testLength").textContent=testLength,carousel.to(3);else{const e=test2problems[test2count-1];test2setResult(test2count,e),test2setButtons(s,t,e)}}else{speechSynthesis.cancel(),playAudio("incorrect",.3);const o=t.findIndex(t=>t==e.target),s=n[o];e.target.textContent=s.en+": "+s.ja,e.target.classList.add("text-danger");const i=test2getTrs();i[test2count-1].classList.add("table-danger")}}function countupStates(){const e=[0,0],t=[...Array(10)].map(()=>Array(2).fill(0));return enjaList.forEach(n=>{const[i,r,s]=n,a=enjaList.findIndex(e=>e[0]==i),o=Math.floor(a/(enjaList.length/10));s?s.slice(-1)=="o"&&(e[1]+=1,t[o][1]+=1):(e[0]+=1,t[o][0]+=1)}),[e,t]}function initProblemRange(){let t,e;const n=new URLSearchParams(location.search);return n.has("q")?([t,e]=n.get("q").split("-"),t=parseInt(t),e=parseInt(e),level=e):(t=1,e=200,level=200),document.getElementById("levelText").textContent=getAward(level),document.getElementById("levelFrom").textContent=t,document.getElementById("levelTo").textContent=e,[t,e]}function initFromIndexedDB(){initProblemRange(),loadEnjaListFromIndexedDB(level,()=>{const[e,t]=countupStates();loadPlans(e),loadProgresses(t)})}function _handleClientLoad(){gapi.load("client:auth2",initClient)}function initClient(){gapi.client.init({apiKey:API_KEY,clientId:CLIENT_ID,discoveryDocs:DISCOVERY_DOCS,scope:SCOPES}).then(e=>{gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus),updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get())}).catch(e=>{console.log(e)})}function updateSigninStatus(e){e&&(initSheet(),document.getElementById("signed").classList.remove("d-none"))}function getAward(e){switch(!0){case e<=200:return"Â∞è6";case e<=400:return"‰∏≠1";case e<=600:return"‰∏≠2";case e<=1e3:return"‰∏≠3";case e<=1400:return"È´ò1";case e<=1800:return"È´ò2";case e<=2600:return"È´ò3";case e<=4e3:return"Â§ßÂ≠¶Áîü";case e<=9e3:return"Á§æ‰ºö‰∫∫";case e<=1e4:return"expatriater";case e<=15e3:return"fighter";case e<=2e4:return"knight";case e<=25e3:return"interpreter";case e<=3e4:return"native";case e<=35e3:return"magician";case e<=4e4:return"demon";default:return"god"}}function initFromSheet(e){loadEnjaListFromSheet(e,()=>{const[e,t]=countupStates();loadPlans(e),loadProgresses(t),putWords()}),setAutoReload()}let reloadedTime,reloadCheckedTime;function setAutoReload(){reloadedTime=Date.now(),reloadCheckedTime=Date.now(),setInterval(function(){const e=Date.now();reloadedTime+33e5<e?reloadCheckedTime+33e5?location.reload():(gapi.auth2.getAuthInstance().currentUser.get().reloadAuthResponse(),reloadedTime=Date.now()):reloadCheckedTime=Date.now(),navigator.onLine?(document.getElementById("signed").classList.remove("d-none"),pendingPush&&(pushWords(),pushIndex())):document.getElementById("signed").classList.add("d-none")},1e3)}function loadEnjaListFromSheet(e,t){const n={};if(e.values)for(let t=0;t<e.values.length;t++){const s=e.values[t],o=s[0],i=s[1];n[o]=i}return fetch("/vocabee/data/"+level+".tsv").then(e=>e.text()).then(e=>{enjaList=[],e.split(`
`).forEach(e=>{const[t,s]=e.split("	");enjaList.push([t,s,n[t]])}),t()})}function getSheetPos(e){switch(!0){case e<=1600:return e/200;case e<=2600:return(e-1800)/400+9;default:return(e-3e3)/1e3+12}}function pushIndex(){const t=localStorage.getItem("vocabee.spreadsheetId"),n=getSheetPos(level);let e=0;enjaList.forEach(t=>{t[2]&&t[2].slice(-1)=="o"&&(e+=1)}),gapi.client.sheets.spreadsheets.values.update({spreadsheetId:t,range:`index!A${n}`,valueInputOption:"RAW",values:[[level,e]]}).then(e=>{pendingPush=!1}).catch(e=>{pendingPush=!0})}function pushWords(){const e=localStorage.getItem("vocabee.spreadsheetId"),t=document.getElementById("levelFrom").textContent,n=document.getElementById("levelTo").textContent,s=enjaList.map(e=>[e[0],e[2]]);gapi.client.sheets.spreadsheets.values.update({spreadsheetId:e,range:`words!A${t}:B${n}`,valueInputOption:"RAW",values:s}).then(e=>{pendingPush=!1}).catch(e=>{pendingPush=!0})}function initSheet(){const e=localStorage.getItem("vocabee.spreadsheetId"),[t,n]=initProblemRange();e&&gapi.client.sheets.spreadsheets.values.get({spreadsheetId:e,range:`words!A${t}:B${n}`}).then(e=>(document.getElementById("spreadsheetIdError").classList.add("d-none"),initFromSheet(e.result))).catch(t=>{switch(t.status){case 400:addSheet(e,"words");break;case 404:document.getElementById("spreadsheetIdError").classList.remove("d-none");break;default:console.log(t)}})}function addSheet(e,t,n){return gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId:e},{requests:[{addSheet:{properties:{title:t}}}]}).then(e=>{n&&n(response)}).catch(e=>{console.log(e)})}document.getElementById("voice").onclick=toggleVoice,document.getElementById("toggleDarkMode").onclick=toggleDarkMode,document.getElementById("test1moveTop").onclick=test1moveTop,document.getElementById("searchByGoogle").onclick=searchByGoogle,document.getElementById("searchGoogle").onclick=search,document.getElementById("searchEijiro").onclick=search,document.getElementById("searchWeblio1").onclick=search,document.getElementById("searchWeblio2").onclick=search,document.getElementById("searchReversoContext").onclick=search,document.getElementById("knownButton").onclick=function(){test1("known")},document.getElementById("unlearnedButton").onclick=function(){test1("unlearned")},document.getElementById("learningButton").onclick=function(){test1("learning")},document.getElementById("test2moveTop").onclick=test2moveTop,document.getElementById("test2all").onclick=test2all,document.getElementById("test2learning").onclick=test2learning,[...document.getElementsByClassName("moveTop")].forEach(e=>{e.onclick=moveTop}),[...document.getElementById("choices").children].forEach(e=>{e.onclick=test2select}),[...document.getElementById("seqTest").children].forEach(e=>{e.onclick=test2seq}),modalNode.addEventListener("shown.bs.modal",function(){const t=document.getElementById("modal-voice"),e=t.previousElementSibling.textContent;document.getElementById("cse-search-input-box-id").value=e,document.getElementById("searchResults").classList.add("d-none"),localStorage.getItem("voice")!=0&&loopVoice(e,3)}),document.getElementById("test2voice").onclick=e=>{const t=e.target.previousElementSibling.textContent;loopVoice(t,3)},document.getElementById("modal-voice").onclick=function(e){const t=e.target.previousElementSibling.textContent;loopVoice(t,3)},test2getTrs().forEach(e=>{const t=e.children,n=t[0].firstChild;n.onclick=function(){loopVoice(t[1].textContent,1)}}),document.addEventListener("click",unlockAudio,{once:!0,useCapture:!0})